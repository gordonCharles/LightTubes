var Seeed_websocket={_socket:{},_guid:"",_user_id:0,_storage:{},_is_connect:0,_send_data:[],_send_time:0,init:function(){Seeed_websocket._storage=window.localStorage,Seeed_websocket._guid=Seeed_websocket._storage.getItem("sdguid"),Seeed_websocket._user_id=Seeed_websocket._storage.getItem("sduserid")?Seeed_websocket._storage.getItem("sduserid"):0,Seeed_websocket.socket_init()},socket_init:function(){this._connect(),this._is_error(),this._is_close(),this._is_msg(),Seeed_websocket._send_data=[],Seeed_websocket.setSocketLoad(4),Seeed_websocket._is_time()},_is_time:function(){return 1!=Seeed_websocket._send_time&&(1==Seeed_websocket._is_connect&&(Seeed_websocket._send_time=1,Seeed_websocket._send()),void setTimeout(Seeed_websocket._is_time,50))},_is_error:function(){Seeed_websocket._socket.onerror=function(e){}},_is_close:function(){Seeed_websocket._socket.onclose=function(e){Seeed_websocket._is_connect=0,Seeed_websocket._send_time=0,Seeed_websocket._is_time(),Seeed_websocket._connect()}},_send:function(){var e=Seeed_websocket._send_data.length;if(e>0)for(var s=0;s<e;s++){var t=Seeed_websocket._send_data.shift(0);setTimeout(function(){Seeed_websocket._socket.send(t)},50)}},_connect:function(){Seeed_websocket._socket=new WebSocket(socketIp)},_disconnect:function(){Seeed_websocket._socket.close()},_auto_disconnect:function(){},_is_msg:function(){Seeed_websocket._socket.onmessage=function(e){var s=$.parseJSON(e.data);1e3==s.type&&(Seeed_websocket._is_connect=1),1==s.type,2==s.type&&($(".j-sign-mycoupon").css("display","none"),$(".j-mycoupon").css("display","none"),"none"==$(".j-sign-myorder").css("display")&&$(".j-sign-name").css("display","none")),3==s.type&&($(".j-sign-myorder").css("display","none"),$(".j-myorder").css("display","none"),"none"==$(".j-sign-mycoupon").css("display")&&$(".j-sign-name").css("display","none")),4==s.type&&Seeed_websocket.view_user(s)}},_is_send:function(e){var s=JSON.stringify(e);0==Seeed_websocket._is_connect?Seeed_websocket._send_data.push(s):Seeed_websocket._socket.send(s)},view_product:function(e){var s={type:1,user_id:Seeed_websocket._user_id,guid:Seeed_websocket._guid,product_id:e};Seeed_websocket._is_send(s)},setSocketLoad:function(e){var s={type:e,user_id:this._user_id,guid:this._guid};this._is_send(s)},view_user:function(e){var s=e.has_new_flag;if(s){$(".j-sign-name").css("display","inline-block");var t=location.pathname;e.has_new_coupon&&"/my_coupon.html"!=t&&($(".j-sign-mycoupon").css("display","inline-block"),$(".j-mycoupon").css("display","inline-block")),e.has_new_order&&"/my_orders.html"!=t&&($(".j-sign-myorder").css("display","inline-block"),$(".j-myorder").css("display","inline-block"))}},test:function(){Seeed_websocket._socket.onmessage=function(e){$.parseJSON(e.data)}},testing:function(){this._socket.send("test")}};Seeed_websocket.init();